<h1><%= @product[:name] %></h1>

Price: <%= @product.formatted_price %>
<p>
<%= @product[:description] %> <br/>

</p>

<h3>Reviews for <%= @product.name %></h3>
 <%= @product.reviews.last.inspect %>
 <% @product.reviews.each do |review| %>
  <p>
  ------------------<br/>
  Comment: <%= review.comment %>
  <br />
    <%if review.user != nil %>
      <em> by <%= review.user.name  %></em><br />
      Added on: <%= review.created_at %>
    <% end %>

   </p> 
 <% end %>

 <% if current_user %>
   <h4>New Review</h4>
   <div id="review-list">
     <%= render :partial => "reviews" %>
 </div>
 <%else %>
   <p>Please <%= link_to "log in", new_session_path %> to add a review.</p>
 <%end%>

<%= link_to "Back", products_path %> | 
<%= link_to "Edit", edit_product_path(@product) %>   <br />
<br />
 <br />
<%= button_to "Delete", @product, method: :delete, :class => :destroy %>

<script type="text/javascript">
  $(document).ready(function(){
    $("#new_review")
    .on('ajax:beforeSend', function() {alert("loading!");})
    .on('ajax:success', function(data, status, xhr) {alert("success");})
    .on('ajax:error', function(xhr, status, error) {alert("error!");})
    .on('ajax:complete ', function() {alert("complete!");})
  });
</script>
