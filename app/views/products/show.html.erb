<h1><%= @product[:name] %></h1>

Price: <%= @product.formatted_price %>
<p>
<%= @product[:description] %> <br/>

</p>

<h3>Reviews for <%= @product.name %></h3>
 <%= @product.reviews.last.inspect %>
 <% @product.reviews.each do |review| %>
  <p>
  ------------------<br/>
  Comment: <%= review.comment %>
  <br />
    <%if review.user != nil %>
      <em> by <%= review.user.name  %></em><br />
      Added on: <%= review.created_at %>
    <% end %>

   </p> 
 <% end %>

 <% if current_user %>
   <h4>New Review</h4>

   <%= form_for [@product, @review], :remote=> true do |f| %>
     <% if @review.errors.any? %>
       <div id="error_explanation">
         <h2><%= pluralize(@review.errors.count, "error") %> prohibited this review from being saved:</h2>
         <ul>
           <% @review.errors.full_message.each do |msg| %>
             <li><%= msg %></li>
           <% end%>
         </ul>
       </div>
     <% end %>

     <div class="field">
       <%= f.label :comment %><br />
       <%= f.text_area :comment %>
     </div> 
     <div class="actions">
       <%= f.submit %><br />
     </div> 
   <% end %>
 <%else %>
   <p>Please <%= link_to "log in", new_session_path %> to add a review.</p>
 <%end%>

<%= link_to "Back", products_path %> | 
<%= link_to "Edit", edit_product_path(@product) %>   <br />
<br />
 <br />
<%= button_to "Delete", @product, method: :delete, :class => :destroy %>
